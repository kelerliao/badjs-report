var BJ_REPORT=function(a){if(a.BJ_REPORT)return a.BJ_REPORT;var b=[],c={id:0,uin:0,url:"",combo:1,ext:{},level:4,ignore:[],random:1,delay:1e3,submit:null},d=function(a,b){return Object.prototype.toString.call(a)==="[object "+(b||"Object")+"]"},e=function(a){var b=typeof a;return"object"===b&&!!a},f=function(a){return null===a?!0:d(a,"Number")?!1:!a},g=a.onerror;a.onerror=function(b,c,e,f,h){var j=b;h&&h.stack&&(j=i(h)),d(j,"Event")&&(j+=j.type?"--"+j.type+"--"+(j.target?j.target.tagName+"::"+j.target.src:""):""),p.push({msg:j,target:c,rowNum:e,colNum:f}),o(),g&&g.apply(a,arguments)};var h=function(a){try{if(a.stack){var b=a.stack.match("https?://[^\n]+");b=b?b[0]:"";var c=b.match(":(\\d+):(\\d+)");c||(c=[0,0,0]);var d=i(a);return{msg:d,rowNum:c[1],colNum:c[2],target:b.replace(c[0],"")}}return a}catch(e){return a}},i=function(a){var b=a.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,5).join("@").replace(/\?[^:]+/gi,""),c=a.toString();return b.indexOf(c)<0&&(b=c+"@"+b),b},j=function(a,b){var d=[],g=[],h=[];if(e(a)){a.level=a.level||c.level;for(var i in a){var j=a[i];if(!f(j)){if(e(j))try{j=JSON.stringify(j)}catch(k){j="[BJ_REPORT detect value stringify error] "+k.toString()}h.push(i+":"+j),d.push(i+"="+encodeURIComponent(j)),g.push(i+"["+b+"]="+encodeURIComponent(j))}}}return[g.join("&"),h.join(","),d.join("&")]},k=[],l=function(a){if(c.submit)c.submit(a);else{var b=new Image;k.push(b),b.src=a}},m=[],n=0,o=function(a){if(c.report){for(;b.length;){var e=!1,f=b.shift(),g=j(f,m.length);if(d(c.ignore,"Array"))for(var h=0,i=c.ignore.length;i>h;h++){var k=c.ignore[h];if(d(k,"RegExp")&&k.test(g[1])||d(k,"Function")&&k(f,g[1])){e=!0;break}}e||(c.combo?m.push(g[0]):l(c.report+g[2]+"&_t="+ +new Date),c.onReport&&c.onReport(c.id,f))}var o=m.length;if(o){var p=function(){clearTimeout(n),l(c.report+m.join("&")+"&count="+o+"&_t="+ +new Date),n=0,m=[]};a?p():n||(n=setTimeout(p,c.delay))}}},p={push:function(a){return Math.random()>=c.random?p:(b.push(e(a)?h(a):{msg:a}),o(),p)},report:function(a){return a&&p.push(a),o(!0),p},info:function(a){return a?(e(a)?a.level=2:a={msg:a,level:2},p.push(a),p):p},debug:function(a){return a?(e(a)?a.level=1:a={msg:a,level:1},p.push(a),p):p},init:function(a){if(e(a))for(var b in a)c[b]=a[b];var d=parseInt(c.id,10);return d&&(c.report=(c.url||"http://badjs2.qq.com/badjs")+"?id="+d+"&uin="+parseInt(c.uin||(document.cookie.match(/\buin=\D+(\d+)/)||[])[1],10)+"&from="+encodeURIComponent(location.href)+"&ext="+JSON.stringify(c.ext)+"&"),p},__onerror__:a.onerror};return"undefined"!=typeof console&&console.error&&setTimeout(function(){var a=((location.hash||"").match(/([#&])BJ_ERROR=([^&$]+)/)||[])[2];a&&console.error("BJ_ERROR",decodeURIComponent(a).replace(/(:\d+:\d+)\s*/g,"$1\n"))},0),p}(window);"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=BJ_REPORT),exports.BJ_REPORT=BJ_REPORT),function(a){if(a.BJ_REPORT){var b,c=function(b){a.BJ_REPORT.report(b)},d=a.BJ_REPORT.tryJs=function(a){return a&&(c=a),d},e=function(a,b){var c;for(c in b)a[c]=b[c]},f=function(a){return"function"==typeof a},g=function(d,e){return function(){try{return d.apply(this,e||arguments)}catch(f){if(c(f),f.stack&&console&&console.error&&console.error("[BJ-REPORT]",f.stack),!b){var g=a.onerror;a.onerror=function(){},b=setTimeout(function(){a.onerror=g,b=null},50)}throw f}}},h=function(a){return function(){for(var b,c=[],d=0,e=arguments.length;e>d;d++)b=arguments[d],f(b)&&(b=g(b)),c.push(b);return a.apply(this,c)}},i=function(a){return function(b,c){if("string"==typeof b)try{b=new Function(b)}catch(d){throw d}var e=[].slice.call(arguments,2);return b=g(b,e.length&&e),a(b,c)}},j=function(a,b){return function(){for(var c,d,e=[],h=0,i=arguments.length;i>h;h++)c=arguments[h],f(c)&&(d=g(c))&&(c.tryWrap=d)&&(c=d),e.push(c);return a.apply(b||this,e)}},k=function(a){var b,c;for(b in a)c=a[b],f(c)&&(a[b]=g(c));return a};d.spyJquery=function(){var b=a.$;if(!b||!b.event)return d;var c=b.event.add,e=b.ajax,g=b.event.remove;if(c&&(b.event.add=j(c),b.event.remove=function(){for(var a,b=[],c=0,d=arguments.length;d>c;c++)a=arguments[c],f(a)&&(a=a.tryWrap),b.push(a);return g.apply(this,b)}),e&&(b.ajax=function(a,c){return c||(c=a,a=void 0),k(c),a?e.call(b,a,c):e.call(b,c)}),$.zepto){var h=b.fn.on,i=b.fn.off;b.fn.on=j(h),b.fn.off=function(){for(var a,b=[],c=0,d=arguments.length;d>c;c++)a=arguments[c],f(a)&&(a=a.tryWrap),b.push(a);return i.apply(this,b)}}return d},d.spyModules=function(){var b=a.require,c=a.define;return c&&c.amd&&b&&(a.require=h(b),e(a.require,b),a.define=h(c),e(a.define,c)),a.seajs&&c&&(a.define=function(){for(var a,b=[],d=0,e=arguments.length;e>d;d++)a=arguments[d],f(a)&&(a=g(a),a.toString=function(a){return function(){return a.toString()}}(arguments[d])),b.push(a);return c.apply(this,b)},a.seajs.use=h(a.seajs.use),e(a.define,c)),d},d.spySystem=function(){return a.setTimeout=i(a.setTimeout),a.setInterval=i(a.setInterval),d},d.spyCustom=function(a){return f(a)?g(a):k(a)},d.spyAll=function(){return d.spyJquery().spyModules().spySystem(),d}}}(window);